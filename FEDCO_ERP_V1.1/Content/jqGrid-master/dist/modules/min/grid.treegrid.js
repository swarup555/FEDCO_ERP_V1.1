var $jscomp={scope:{},findInternal:function(d,q,n){d instanceof String&&(d=String(d));for(var r=d.length,u=0;u<r;u++){var m=d[u];if(q.call(n,m,u,d))return{i:u,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,q,n){if(n.get||n.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[q]=n.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,q,n,r){if(q){n=$jscomp.global;d=d.split(".");for(r=0;r<d.length-1;r++){var u=d[r];u in n||(n[u]={});n=n[u]}d=d[d.length-1];r=n[d];q=q(r);q!=r&&null!=q&&$jscomp.defineProperty(n,d,{configurable:!0,writable:!0,value:q})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,n){return $jscomp.findInternal(this,d,n).v}},"es6-impl","es3");
(function(d){"function"===typeof define&&define.amd?define(["jquery","./grid.base"],d):"object"===typeof exports?d(require("jquery")):d(jQuery)})(function(d){var q=d.jgrid,n=q.getAccessor,r=q.stripPref,u=q.jqID,m=d.fn.jqGrid,v=function(){var a=d.makeArray(arguments);a[0]="treeGrid"+a[0].charAt(0).toUpperCase()+a[0].substring(1);a.unshift("");a.unshift("");a.unshift(this.p);return q.feedback.apply(this,a)};q.extend({setTreeNode:function(){return this.each(function(){var a=d(this),b=this.p;if(this.grid&&
b.treeGrid){var c=b.treeReader.expanded_field,g=b.treeReader.leaf_field;a.off("jqGridBeforeSelectRow.setTreeNode");a.on("jqGridBeforeSelectRow.setTreeNode",function(e,h,k){if(null!=k){e=d(k.target);k=e.closest("tr.jqgrow>td");var l=k.parent(),f=function(){var d=b.data[b._index[r(b.idPrefix,h)]],e=d[c]?"collapse":"expand";d[g]||(m[e+"Row"].call(a,d,l),m[e+"Node"].call(a,d,l))};e.is("div.treeclick")?f():b.ExpandColClick&&0<k.length&&0<e.closest("span.cell-wrapper",k).length&&f();return!0}})}})},setTreeGrid:function(){return this.each(function(){var a=
this.p,b,c,g,e=[],h=["leaf_field","expanded_field","loaded"];if(a.treeGrid){a.treedatatype||d.extend(this.p,{treedatatype:a.datatype});a.subGrid=!1;a.altRows=!1;a.pgbuttons=!1;a.pginput=!1;a.gridview=!0;null===a.rowTotal&&(a.rowNum=a.maxRowNum);a.rowList=[];a.treeIcons.plus="rtl"===a.direction?a.treeIcons.plusRtl:a.treeIcons.plusLtr;"nested"===a.treeGridModel?a.treeReader=d.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",
icon_field:"icon"},a.treeReader):"adjacency"===a.treeGridModel&&(a.treeReader=d.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},a.treeReader));for(c in a.colModel)if(a.colModel.hasOwnProperty(c))for(g in b=a.colModel[c].name,a.treeReader)a.treeReader.hasOwnProperty(g)&&a.treeReader[g]===b&&e.push(b);d.each(a.treeReader,function(b){var c=String(this);c&&-1===d.inArray(c,e)&&(0<=d.inArray(b,h)?a.additionalProperties.push({name:c,
search:!1,convert:function(a){return!0===a||"true"===String(a).toLowerCase()||"1"===String(a)?!0:a}}):a.additionalProperties.push(c))})}})},expandRow:function(a){this.each(function(){var b=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,e=a[c.localReader.id];if(v.call(this,"beforeExpandRow",{rowid:e,item:a})){var h=m.getNodeChildren.call(b,a);d(h).each(function(){var a=c.idPrefix+n(this,c.localReader.id);d(m.getGridRowById.call(b,a)).css("display","");this[g]&&m.expandRow.call(b,
this)});v.call(this,"afterExpandRow",{rowid:e,item:a})}}})},collapseRow:function(a){this.each(function(){var b=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,e=a[c.localReader.id];if(v.call(this,"beforeCollapseRow",{rowid:e,item:a})){var h=m.getNodeChildren.call(b,a);d(h).each(function(){var a=c.idPrefix+n(this,c.localReader.id);d(m.getGridRowById.call(b,a)).css("display","none");this[g]&&m.collapseRow.call(b,this)});v.call(this,"afterCollapseRow",{rowid:e,item:a})}}})},
getRootNodes:function(){var a=[];this.each(function(){var b=this.p;if(this.grid&&b.treeGrid)switch(b.treeGridModel){case "nested":var c=b.treeReader.level_field;d(b.data).each(function(){parseInt(this[c],10)===parseInt(b.tree_root_level,10)&&a.push(this)});break;case "adjacency":var g=b.treeReader.parent_id_field;d(b.data).each(function(){null!==this[g]&&"null"!==String(this[g]).toLowerCase()||a.push(this)})}});return a},getNodeDepth:function(a){var b=null;this.each(function(){var c=this.p;if(this.grid&&
c.treeGrid)switch(c.treeGridModel){case "nested":b=parseInt(a[c.treeReader.level_field],10)-parseInt(c.tree_root_level,10);break;case "adjacency":b=m.getNodeAncestors.call(d(this),a).length}});return b},getNodeParent:function(a){var b=this[0];if(!b||!b.grid||null==b.p||!b.p.treeGrid||null==a)return null;var b=b.p,c=b.treeReader,g=a[c.parent_id_field];if("nested"===b.treeGridModel){var e=null,h=c.left_field,k=c.right_field,l=c.level_field,f=parseInt(a[h],10),p=parseInt(a[k],10),m=parseInt(a[l],10);
d(b.data).each(function(){if(parseInt(this[l],10)===m-1&&parseInt(this[h],10)<f&&parseInt(this[k],10)>p)return e=this,!1});return e}if(null===g||"null"===g)return null;a=b._index[g];return void 0!==a?b.data[a]:null},getNodeChildren:function(a){var b=[];this.each(function(){var c=this.p;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":var g=c.treeReader.left_field,e=c.treeReader.right_field,h=c.treeReader.level_field,k=parseInt(a[g],10),l=parseInt(a[e],10),f=parseInt(a[h],10);d(c.data).each(function(){parseInt(this[h],
10)===f+1&&parseInt(this[g],10)>k&&parseInt(this[e],10)<l&&b.push(this)});break;case "adjacency":var p=c.treeReader.parent_id_field,m=c.localReader.id;d(c.data).each(function(){String(this[p])===String(a[m])&&b.push(this)})}});return b},getFullTreeNode:function(a){var b=[];this.each(function(){var c=this.p,g;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":var e=c.treeReader.left_field,h=c.treeReader.right_field,k=c.treeReader.level_field,l=parseInt(a[e],10),f=parseInt(a[h],10),m=parseInt(a[k],
10);d(c.data).each(function(){parseInt(this[k],10)>=m&&parseInt(this[e],10)>=l&&parseInt(this[e],10)<=f&&b.push(this)});break;case "adjacency":if(a){b.push(a);var q=c.treeReader.parent_id_field,n=c.localReader.id;d(c.data).each(function(){var a;g=b.length;for(a=0;a<g;a++)if(String(b[a][n])===String(this[q])){b.push(this);break}})}}});return b},getNodeAncestors:function(a){var b=[];this.each(function(){var c=d(this),g=m.getNodeParent;if(this.grid&&this.p.treeGrid)for(var e=g.call(c,a);e;)b.push(e),
e=g.call(c,e)});return b},isVisibleNode:function(a){var b=!0;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid){var g=m.getNodeAncestors.call(d(this),a),e=c.treeReader.expanded_field;d(g).each(function(){b=b&&this[e];if(!b)return!1})}});return b},isNodeLoaded:function(a){var b;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.leaf_field,c=c.treeReader.loaded;b=void 0!==a?void 0!==a[c]?a[c]:a[g]||0<m.getNodeChildren.call(d(this),a).length?!0:!1:!1}});return b},
expandNode:function(a){return this.each(function(){var b=this.p;if(this.grid&&b.treeGrid){var c=b.treeReader.expanded_field,g=b.treeReader.parent_id_field,e=b.treeReader.loaded,h=b.treeReader.level_field,k=b.treeReader.left_field,l=b.treeReader.right_field;if(!a[c]){var f=n(a,b.localReader.id);if(v.call(this,"beforeExpandNode",{rowid:f,item:a})){var p=d("#"+b.idPrefix+u(f),this.grid.bDiv)[0],q=b._index[f];"local"===b.treedatatype||m.isNodeLoaded.call(d(this),b.data[q])?(a[c]=!0,d("div.treeclick",
p).removeClass(b.treeIcons.plus+" tree-plus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.minus+" tree-minus")):this.grid.hDiv.loading||(a[c]=!0,d("div.treeclick",p).removeClass(b.treeIcons.plus+" tree-plus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.minus+" tree-minus"),b.treeANode=p.rowIndex,b.datatype=b.treedatatype,m.setGridParam.call(d(this),{postData:"nested"===b.treeGridModel?{nodeid:f,n_level:a[h],n_left:a[k],n_right:a[l]}:{nodeid:f,n_level:a[h],parentid:a[g]}}),
d(this).trigger("reloadGrid"),a[e]=!0,m.setGridParam.call(d(this),{postData:"nested"===b.treeGridModel?{nodeid:"",n_level:"",n_left:"",n_right:""}:{nodeid:"",n_level:"",parentid:""}}));v.call(this,"afterExpandNode",{rowid:f,item:a})}}}})},collapseNode:function(a){return this.each(function(){var b=this.p;if(this.grid&&b.treeGrid){var c=b.treeReader.expanded_field;if(a[c]){var g=n(a,b.localReader.id);if(v.call(this,"beforeCollapseNode",{rowid:g,item:a})){a[c]=!1;d("#"+b.idPrefix+u(g),this.grid.bDiv).find("div.treeclick").removeClass(b.treeIcons.minus+
" tree-minus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.plus+" tree-plus");if(!0===b.unloadNodeOnCollapse||d.isFunction(b.unloadNodeOnCollapse)&&b.unloadNodeOnCollapse.call(this,a))a[b.treeReader.loaded]=!1,d(this).jqGrid("delTreeNode",g,!0);v.call(this,"afterCollapseNode",{rowid:g,item:a})}}}})},SortTree:function(a,b,c,g){return this.each(function(){var e=this,h=e.p,k=d(e);if(e.grid&&h.treeGrid){var l,f,p,B=[];l=m.getRootNodes.call(k);l=q.from.call(e,l);l.orderBy(a,b,c,g);var r=
l.select();l=0;for(f=r.length;l<f;l++)p=r[l],B.push(p),m.collectChildrenSortTree.call(k,B,p,a,b,c,g);d.each(B,function(a){var b=n(this,h.localReader.id);d(e.rows[a]).after(k.find(">tbody>tr#"+u(b)))})}})},collectChildrenSortTree:function(a,b,c,g,e,h){return this.each(function(){var k=d(this);if(this.grid&&this.p.treeGrid){var l,f,p;l=m.getNodeChildren.call(k,b);l=q.from.call(this,l);l.orderBy(c,g,e,h);var n=l.select();l=0;for(f=n.length;l<f;l++)p=n[l],a.push(p),m.collectChildrenSortTree.call(k,a,
p,c,g,e,h)}})},setTreeRow:function(a,b){var c=!1;this.each(function(){this.grid&&this.p.treeGrid&&(c=m.setRowData.call(d(this),a,b))});return c},delTreeNode:function(a,b){return this.each(function(){var c=this.p,g,e,h,k;h=c.localReader.id;var l,f=d(this),p=c.treeReader.left_field,n=c.treeReader.right_field;if(this.grid&&c.treeGrid&&(l=c._index[a],void 0!==l)){g=parseInt(c.data[l][n],10);e=g-parseInt(c.data[l][p],10)+1;var r=m.getFullTreeNode.call(f,c.data[l]);if(0<r.length)for(l=0;l<r.length;l++)b&&
a===r[l][h]||m.delRowData.call(f,r[l][h]);if("nested"===c.treeGridModel){h=q.from.call(this,c.data).greater(p,g,{stype:"integer"}).select();if(h.length)for(k in h)h.hasOwnProperty(k)&&(h[k][p]=parseInt(h[k][p],10)-e);h=q.from.call(this,c.data).greater(n,g,{stype:"integer"}).select();if(h.length)for(k in h)h.hasOwnProperty(k)&&(h[k][n]=parseInt(h[k][n],10)-e)}}})},addChildNode:function(a,b,c,g){return this.each(function(){if(c){var e=this.p,h=d(this),k=m.getInd,l,f,p,n,r,u=b,v,y=e.treeReader.expanded_field,
z=e.treeReader.leaf_field,G=e.treeReader.level_field,I=e.treeReader.parent_id_field,x=e.treeReader.left_field,w=e.treeReader.right_field,C=e.treeReader.loaded;void 0===g&&(g=!1);null==a&&(a=q.randId());var H=k.call(h,b);v=!1;if(void 0===b||null===b||""===b)u=b=null,l="last",n=e.tree_root_level;else{l="after";f=e._index[b];p=e.data[f];b=p[e.localReader.id];r=k.call(h,b);n=parseInt(p[G],10)+1;var D=m.getFullTreeNode.call(h,p);if(D.length){var A,E,F;for(A=0;A<D.length;A++)F=D[A][e.localReader.id],E=
k.call(h,F),E>r&&(r=E,u=F)}p[z]&&(v=!0,p[y]=!0,d(this.rows[H]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(e.treeIcons.leaf+" tree-leaf").addClass(e.treeIcons.commonIconClass).addClass(e.treeIcons.minus+" tree-minus"),e.data[f][z]=!1,p[C]=!0)}void 0===c[y]&&(c[y]=!1);void 0===c[C]&&(c[C]=!1);c[G]=n;void 0===c[z]&&(c[z]=!0);"adjacency"===e.treeGridModel&&(c[I]=b);if("nested"===e.treeGridModel){var t;if(null!==b){k=parseInt(p[w],
10);e=q.from.call(this,e.data);e=e.greaterOrEquals(w,k,{stype:"integer"});f=e.select();if(f.length)for(t in f)f.hasOwnProperty(t)&&(f[t][x]=f[t][x]>k?parseInt(f[t][x],10)+2:f[t][x],f[t][w]=f[t][w]>=k?parseInt(f[t][w],10)+2:f[t][w]);c[x]=k;c[w]=k+1}else{k=parseInt(m.getCol.call(h,w,!1,"max"),10);f=q.from.call(this,e.data).greater(x,k,{stype:"integer"}).select();if(f.length)for(t in f)f.hasOwnProperty(t)&&(f[t][x]=parseInt(f[t][x],10)+2);f=q.from.call(this,e.data).greater(w,k,{stype:"integer"}).select();
if(f.length)for(t in f)f.hasOwnProperty(t)&&(f[t][w]=parseInt(f[t][w],10)+2);c[x]=k+1;c[w]=k+2}}(null===b||m.isNodeLoaded.call(h,p)||v)&&m.addRowData.call(h,a,c,l,u);p&&!p[y]&&g&&d(this.rows[H]).find("div.treeclick").click()}})}})});
//# sourceMappingURL=grid.treegrid.map
